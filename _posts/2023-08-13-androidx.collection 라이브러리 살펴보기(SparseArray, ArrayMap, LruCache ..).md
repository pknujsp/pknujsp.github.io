---
layout: post
title: android.util 라이브러리 중 자료구조 살펴보기(SparseArray, ArrayMap, LruCache ..)
subtitle: ArrayMap, ArraySet, CircularArray, SparseArray, LruCache, SimpleArrayMap ..
published: true
categories: Kotlin
tags: [Kotlin]
---

## android.util 라이브러리 소개
---
> Android 개발 시 자주 사용될 수 있는 시간 처리, base64 인코딩, 자료구조 등의 기능을 제공하는 라이브러리입니다.

이 글에서는 자료 구조에 대해 집중적으로 살펴봅니다.

## android.util 내 자료구조의 종류

| Class         | Description                                                      |
| ------------- | ---------------------------------------------------------------- |
| ArrayMap      | 기본 `HashMap`보다 더 메모리 효율적인 Map구조를 제공합니다.      |
| ArraySet      | 기본 `HashSet`보다 더 메모리 효율적인 Set구조를 제공합니다.      |
| CircularArray | 원형 배열 자료구조, O(1)시간에 랜덤 읽기/요소 추가를 제공합니다. |
| SparseArray   | 기본 `HashMap`보다 더 메모리 효율적인 Map구조를 제공합니다.      |
| LruCache      | `Map`구조를 기반으로 값을 Cache로 관리하는 자료구조입니다.       |


## ArrayMap
---
> `HashMap`을 개선한 버전입니다. `HashMap`보다 좀 더 메모리 효율적입니다.

#### HashMap

![HashMap](https://github.com/pknujsp/BestWeather/assets/48265129/6d640467-4eae-4c6c-9756-ac2056fb2947)

#### ArrayMap

![ArrayMap](https://github.com/pknujsp/BestWeather/assets/48265129/7419a527-6fe5-4bdb-973d-3f5554002198)


### 구조

- 구조
  - `HashMap`
    - 배열 1개를 사용합니다.
    - 키와 값을 저장하는 배열
    - 키에 대해 Hash값을 구함 -> Hash값을 배열의 Index로 사용 -> 해당 Index에 값을 가져온다.
  - `ArrayMap`
    - 배열 2개를 사용합니다.
    - 키와 Hash값을 저장하는 배열, 키와 값의 쌍을 저장하는 배열
    - 키에 대해 Hash값을 구함 -> Hash값으로 Key Index를 구함 -> 키와 값 쌍 배열에서 Key Index에 해당하는 값을 가져온다. 
- 키 값 배열 크기 관리
  - 데이터가 추가(제거)되면 배열을 사용되는 만큼 확장(축소)합니다.'


### 장점

- 낭비되는 메모리가 없습니다.
  - `HashMap`
    - Map이 비어있더라도 기본적인 크기만큼 메모리가 할당되어 메모리가 낭비됩니다.
  - `ArrayMap`
    - Map이 비어있으면, 아무것도 가지고 있지 않아 메모리가 할당되어 있지 않아 낭비되는 부분이 없습니다.
- 데이터 처리 시 메모리 효율직입니다.
  - 키를 가지고 값을 찾을때 `HashMap`은 Iterator를 통해서 값을 찾지만, `ArrayMap`은 배열의 Index로 값을 찾기 때문에 메모리를 좀더 효율적으로 사용하게 됩니다.

### 단점

- 데이터 조회 성능이 `HashMap`보다 떨어집니다.
  - `ArrayMap`은 대량의 데이터를 처리하기에는 적합하지 않습니다.
  - Hash계산으로 바로 값을 가져올 수 있는 `HashMap`와 달리 `ArrayMap`은 Hash계산 후 키와 값
- 스레드 동기화에 취약합니다.
  - 인스턴스에 대해 동기화가 필요 없는 단일 스레드 환경에서 사용하기 적합합니다.

### 예제 코드

```kotlin
val arrayMap = ArrayMap<String, Int>()
arrayMap.put("Name", "ArrayMap")
val value = arrayMap.get("Name") // value is ArrayMap
```

## ArraySet
---
> `HashSet`을 개선한 버전입니다. `HashSet`보다 좀 더 메모리 효율적이고, `ArrayMap`과 유사합니다.


#### HashSet

![HashSet](https://github.com/pknujsp/BestWeather/assets/48265129/54d18053-3a62-4916-9711-5ee9aab81198)

#### ArraySet

![ArraySet](https://github.com/pknujsp/BestWeather/assets/48265129/60c13a63-25d8-4aec-873a-5af257a06ff5)